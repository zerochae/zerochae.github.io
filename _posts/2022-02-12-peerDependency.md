---
title: Issue &#35;1
description: Peer Dependency
date: 2022-02-11 09:00
category: Issue
tags: [Issue]
---

## unable to resolve dependency tree

![Error](https://user-images.githubusercontent.com/84373490/153573779-801d3bb0-4fe0-4e9c-b04b-86b86ed67254.jpg)

í”„ë¡œì íŠ¸ ì´ˆê¸°ì„¤ì •ì„ ìœ„í•´ `craco`ë¥¼ ì„¤ì¹˜í•˜ë˜ ì¤‘ ì—ëŸ¬ë¥¼ ë§Œë‚¬ë‹¤.

ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ ì½ì–´ë³´ë‹ˆ `craco` ì„¤ì¹˜ë¥¼ ìœ„í•´ì„œëŠ” `react-scripts ^4.0.0`ì´ í•„ìš”í•œë°, í˜„ì¬ í”„ë¡œì íŠ¸ëŠ” `react-scripts 5.0.0` ë¼ëŠ” ë²„ì „ ì—ëŸ¬ì´ë‹¤. ê·¸ë¦¬ê³  `--force`ë‚˜ `--legacy-peer-deps` í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•˜ë©´ í•´ê²°í•  ìˆ˜ ìˆì§€ë§Œ ì ì¬ì ìœ¼ë¡œ ê¹¨ì§ˆ ìˆ˜ ìˆì§€ë§Œ í•´ê²°í•  ìˆ˜ ìˆë‹¤ê³  í•œë‹¤.

[What does npm install --legacy-peer-deps do exactly?ğŸš€](https://stackoverflow.com/questions/66239691/what-does-npm-install-legacy-peer-deps-do-exactly-when-is-it-recommended-wh)

[When to use --force and --legacy-peer-deps?ğŸš€](https://stackoverflow.com/questions/66020820/npm-when-to-use-force-and-legacy-peer-deps)

ìœ„ ë¬¸ì„œì˜ ìš”ì•½ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

ìš°ë¦¬ê°€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„¤ì¹˜í•˜ë©´ `package.json`ì˜ `dependencies` , `devDependencies` í•­ëª©ì— ê¸°ë¡ì´ ëœë‹¤. ê·¸ë¦¬ê³  ì—¬ê¸°ì— ê¸°ë¡ë˜ì§€ ì•ŠëŠ” `peerDependencies` ë¼ëŠ” í•­ëª©ì´ ìˆë‹¤. ì´ í•­ëª©ì€ í•´ë‹¹ ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ ì‹¤í–‰ì„ ìœ„í•´ì„œ í•„ìš”í•œ `dependencies`ì˜ ì •ë³´ì´ë‹¤. ì´ í•­ëª©ì€ `package-lock.json`ì— ê¸°ë¡ë˜ì–´ ìˆë‹¤.

![peer](https://user-images.githubusercontent.com/84373490/153626757-acc2be23-6b51-4bc5-b2fa-ee9b71709303.jpg)

`react-scripts`ì˜ ë²„ì „ ì •ë³´ê°€ `^4.0.0` ìœ¼ë¡œ í‘œê¸° ë˜ì–´ìˆë‹¤. `caret(^)` ê¸°í˜¸ëŠ” ìˆ«ìì˜ ê°œìˆ˜, 0ì˜ ì²˜ìŒ ìœ„ì¹˜ì— ë”°ë¼ ê·¸ ëœ»ì´ ë‹¬ë¼ì§€ëŠ”ë° ì—¬ê¸°ì„œëŠ” 4.0.0 <= version < 5.0.0 ì‚¬ì´ì˜ ë²„ì „(`4.*.*`)ì„ ì˜ë¯¸í•œë‹¤.  

`dependency`ëŠ” ë‚´ê°€ ë§Œë“  ëª¨ë“ˆì—ì„œ ì‚¬ìš©í•˜ëŠ” íŒ¨í‚¤ì§€ë¥¼ ì§€ì •í•˜ëŠ” ë°˜ë©´, `peerDependencies`ëŠ” ë°˜ëŒ€ë¡œ ë‚´ê°€ ë§Œë“  ëª¨ë“ˆì´ ë‹¤ë¥¸ ëª¨ë“ˆê³¼ í•¨ê»˜ ë™ì‘í•  ìˆ˜ ìˆë‹¤ëŠ” í˜¸í™˜ì„±ì„ í‘œì‹œí•˜ëŠ” ê²ƒì´ë‹¤. ì´ëŸ° ê²ƒì„ í”ŒëŸ¬ê·¸ì¸ì´ë¼ê³  í•œë‹¤.

ë§ì´ ì–´ë µì§€ë§Œ, ë°‘ì„ ê³„ì† ë³´ë©´ ì‰½ê²Œ ì´í•´í•  ìˆ˜ ìˆë‹¤.

ìš°ë¦¬ëŠ” `craco`ë¥¼ ì„¤ì¹˜í•˜ë ¤ê³  í–ˆì„ ë•Œ `carco`ì˜ `peerDependencies` í•­ëª©ì˜ `react-scripts ^4.0.0`ì´ í•„ìš”í•˜ë‹¤ê³  í–ˆì§€ë§Œ í”„ë¡œì íŠ¸ì—ëŠ” `react-scripts 5.0.0`ì´ê¸° ë•Œë¬¸ì— ì˜¤ë¥˜ê°€ ë°œìƒí•œ ê²ƒ ì´ë‹¤.

`npm VER.4 ~ 6` ê¹Œì§€ëŠ” `peerDependencies` ê´€ë ¨ ì´ìŠˆê°€ ë°œìƒí•˜ë©´ ì˜¤ë¥˜ê°€ ì•„ë‹Œ ê²½ê³ ë¥¼ ì¶œë ¥í–ˆì§€ë§Œ, 21ì›” 2ì›” `npm VER.7`ì´ ì¶œì‹œë˜ë©´ì„œ(í˜„ì¬ëŠ” `VER.8`) ì˜¤ë¥˜ê°€ ë°œìƒí•˜ëŠ”ê²ƒìœ¼ë¡œ ë³€ê²½ë˜ì—ˆë‹¤. 

### force

ì—¬ê¸°ì„œ `--force` í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•˜ë©´ í•„ìš”í•œ `peerDependencies`ë¥¼ ì¶”ê°€ í›„, ì„¤ì¹˜ë¥¼ ì§„í–‰í•œë‹¤.

![force](https://user-images.githubusercontent.com/84373490/153630787-d53ebd82-7829-4038-babf-bee1b9c3766e.jpg)

ìœ„ ì‚¬ì§„ì—ì„œëŠ” `react-scripts ^4.0.0`ì„ ì„¤ì¹˜í•˜ë ¤í–ˆì§€ë§Œ ì¶©ëŒì´ ë°œìƒí•˜ì—¬ ì •ìƒ ì™„ë£Œ ë˜ì§€ ì•Šì•˜ëŠ”ë°, ì´ìƒí•˜ê²Œ `craco`ëŠ” ì„¤ì¹˜ê°€ ë˜ì—ˆê³  **í”„ë¡œì íŠ¸ë¥¼ ì‹¤í–‰**ì‹œí‚¬ ìˆ˜ ìˆì—ˆë‹¤.ì—¬ê¸°ì„œ ë§Œì•½ ì„¤ì¹˜ì— ì‹¤íŒ¨í•œë‹¤ë©´ 
```
npm ERR! Fix the upstream dependency conflict, or retry
npm ERR! this command with --force, or --legacy-peer-deps
npm ERR! to accept an incorrect (and potentially broken) dependency resolution.
```
ë¼ëŠ” ì˜¤ë¥˜ ë©”ì‹œì§€ë¥¼ ì¶œë ¥í•œë‹¤.

ìì„¸í•œ ê²°ê³¼ë¥¼ ë³´ê³  ì‹¶ìœ¼ë©´ `npm audit`ì„ ì…ë ¥í•˜ë¼ëŠ” ë©”ì‹œì§€ê°€ ìˆê¸¸ë˜ ì…ë ¥í•´ë³´ì•˜ë‹¤.

![audit1](https://user-images.githubusercontent.com/84373490/153698744-7354d2c4-b6eb-415a-a8ec-c715c4d41cfd.jpg)

`Will install react-scripts@3.0.1, which is a breaking change` ë¼ëŠ” ë§ì´ ë³´ì¸ë‹¤.

`react-scripts@3.0.1`ë¥¼ ì„¤ì¹˜í•˜ëŠ” ê²ƒì´ ì£¼ìš” ë³€ê²½ ì‚¬í•­ì— ë“±ë¡ë˜ì–´ ìˆë‹¤. ìŒ.. `3.0.1`ë²„ì „ì€ ìœ„ì—ì„œ ë§í•œ ì‚¬ì´ì˜ ë²„ì „ê³¼ ë§ì§€ ì•ŠëŠ”ë° ì™œ ê°‘ìê¸° ë“±ì¥í•˜ì˜€ì„ê¹Œ? ê·¸ ì´ìœ ëŠ” `craco`ì˜ ë²„ì ¼ë„ ê°™ì´ `5.9.0`ë¡œ ë‚´ë ¤ê°”ê¸° ë•Œë¬¸ì´ë‹¤.

![craco 5 9 0](https://user-images.githubusercontent.com/84373490/153703526-8588bb0d-284c-45ca-a8d9-8c1aafc1f178.jpg)

`craco@5.9.0`ì€ `react-scripts`ì˜ ëª¨ë“  ë²„ì „ê³¼ í˜¸í™˜ëœë‹¤. 

ìŒ.. ì²˜ìŒë¶€í„° `craco@5.9.0` ì„ ì„¤ì¹˜í–ˆë‹¤ë©´ ëª¨ë“ ê²Œ í•´ê²° ë˜ì—ˆì„ ê²ƒ ì´ë‹¤. 

ì–´ì¨‹ë“  ë“±ë¡ë˜ì—ˆìœ¼ë‹ˆ, `npm audit fix --force` ë¥¼ ì…ë ¥í•˜ì—¬ ë³€ê²½ ì‚¬í•­ì„ ì‹¤í–‰ì‹œì¼œë³´ì.(ë¶ˆì•ˆí•˜ë‹¤.) 

![fix1](https://user-images.githubusercontent.com/84373490/153698869-a34621ff-b125-486d-9b00-c3c9977f491b.jpg)

ì²˜ìŒì—” ë˜‘ê°™ì´ ì¶©ëŒí–ˆë‹¤ëŠ” ë©”ì‹œì§€ê°€ ë‚˜ì˜¤ë”ë‹ˆ ë¬´ì–¸ê°€ ë°”ë€Œê¸° ì‹œì‘í•œë‹¤.

![result1](https://user-images.githubusercontent.com/84373490/153698885-ddb3aea8-d499-4e64-b2dd-63471d582722.jpg)

ìŒ... ë‚˜ëŠ” `react-script` í•˜ë‚˜ë¥¼ ë°”ê¾¸ê³  ì‹¶ì—ˆë˜ ê²ƒ ë¿ì¸ë°.. 830ê°œì˜ íŒ¨í‚¤ì§€ê°€ ì¶”ê°€ë˜ê³  308ê°œê°€ ì œê±°ë˜ê³  369ê°œê°€ ë°”ë€Œì—ˆë‹¤ê³  í•œë‹¤. 

ê·¸ë¦¬ê³  ë‹¤ì‹œ `npm audit`ì„ ì…ë ¥í•´ë³´ë©´ react-scriptì˜ `5.0.0`ì„ ì£¼ìš” ë³€ê²½ ì‚¬í•­ì— ë“±ë¡í•´ë†“ì•˜ëŠ”ë° ì´ëŠ” `5.0.0`ë²„ì „ì„ `peer Dependency`ë¡œ í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ìˆê¸° ë•Œë¬¸ì´ë‹¤.

![result3](https://user-images.githubusercontent.com/84373490/153700848-2280accf-6f1c-457c-b084-926349e0ea38.jpg)

ì–´ì¨‹ë“ .. ì˜ë„í•œ ëŒ€ë¡œ(?) ë²„ì „ì´ ë°”ë€Œì–´ìˆë‹¤. ì´ì œ ì‹¤í–‰í•˜ë©´ í•´ë³´ë©´

![ì‹¤í–‰ì•ˆë¼](https://user-images.githubusercontent.com/84373490/153699591-8c8863d2-de91-44cc-a793-34129239edb9.jpg)
.
**ì•ˆëœë‹¤.** ì•ì„œ ë§í•œê²ƒì²˜ëŸ¼ ë‹¤ë¥¸ë¶€ë¶„ì—ì„œ `react-script 5.0.0`ì„ í•„ìš”ë¡œ í•˜ê¸° ë•Œë¬¸ì´ë‹¤. 

ì–´ë–»ê²Œ í•´ì•¼ í•˜ë‚˜ ê³ ë¯¼ì„ í•˜ë‹¤ê°€ ê³µì‹ë¬¸ì„œì—ì„œ í•´ë‹µì„ ì°¾ì„ ìˆ˜ ìˆì—ˆë‹¤

ë§¨ ì²˜ìŒ `craco`ë¥¼ `--force` í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•´ ì„¤ì¹˜í•˜ê³ , `peerDependency`ì˜ ë²„ì „ì´ ë§ì§€ ì•Šì•˜ëŠ”ë° runì´ ëœ ì´ìœ ëŠ” `craco`ì—ì„œ react-scriptì˜ ë²„ì „ ì»¤ìŠ¤í…€ì„ ì§€ì›í•˜ê¸° ë•Œë¬¸ì´ì˜€ë‹¤. ì´ ê¸°ëŠ¥ì€ `craco`ê°€ ë²„ì „ì—…ë˜ë©´ì„œ ì¶”ê°€ëœ ê¸°ëŠ¥ì¸ê²ƒ ê°™ë‹¤. ê·¸ëƒ¥ `5.0.0` ë²„ì „ì—ì„œë„ ì‚¬ìš© ê°€ëŠ¥ í•˜ë‹¤ëŠ” ë§ì´ë‹¤. 

![cracoconfig](https://user-images.githubusercontent.com/84373490/153699678-5d4a61b7-e869-462e-aeba-85b80ad500e6.jpg)

ì—­ì‹œ.. ê³µì‹ë¬¸ì„œë¥¼ ì˜ ì½ëŠ” ìŠµê´€ì„ ë“¤ì—¬ì•¼ í•œë‹¤ëŠ”ê±¸ ë‹¤ì‹œ í•œë²ˆ ëŠê¼ˆë‹¤.

### legacy-peer-deps

`--legacy-peer-deps` í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•˜ë©´ `peerDependencies` ì„¤ì¹˜ ì—†ì´, ì„¤ì¹˜ë¥¼ ì§„í–‰í•œë‹¤.

![legacy](https://user-images.githubusercontent.com/84373490/153620989-6b802011-9255-4e0a-85bb-33b29e6a1d32.jpg)

í•„ìš”í•œ `peerDependency`ë¥¼ ì„¤ì¹˜í•˜ë ¤ëŠ” ì‹œë„ë¥¼ í•˜ì§€ ì•Šê³  í•´ë‹¹ ì´ìŠˆë¥¼ ë¬´ì‹œí•œë‹¤. ê·¸ë¦¬ê³  ìœ„ì™€ ë§ˆì°¬ê°€ì§€ë¡œ ì‹¤í–‰ì´ ë˜ëŠ” ì´ìœ ëŠ” ë²„ì „ ì»¤ìŠ¤í…€ì„ ì§€ì›í•˜ê¸° ë•Œë¬¸ì´ë‹¤.

## ê²°ë¡ 

ì²˜ìŒ í•´ë‹¹ ì´ìŠˆë¡œ êµ¬ê¸€ë§ì„ í•˜ì˜€ì„ë•Œ `craco`ì„¤ì¹˜ ì‹œ `--legacy-peer-deps`ë¥¼ ì…ë ¥í•˜ë¼ëŠ” ê¸€ì„ ë¨¼ì € ë°œê²¬í•˜ì˜€ë‹¤. ê·¸ ì´ìœ ëŠ” ìœ„ì—ì„œ ë§í•œ ëŒ€ë¡œ ë²„ì „ ì»¤ìŠ¤í…€ ë•ë¶„ì— ì¶”ê°€ë¡œ `dependency`ë¥¼ ì„¤ì¹˜í•  í•„ìš”ê°€ ì—†ê¸° ë•Œë¬¸ì´ë‹¤. í•˜ì§€ë§Œ ë§Œì•½ ë‹¤ë¥¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš© ì‹œ í•´ë‹¹ ì´ìŠˆë¥¼ ë§Œë‚œë‹¤ë©´ `--force` í‚¤ì›Œë“œ ì‚¬ìš©ì„ ì¶”ì²œí•œë‹¤. ë²„ì „ì„ ê³ ì •ì‹œí‚¤ë ¤ëŠ” ì‹œë„ê°€ ìˆê¸° ë•Œë¬¸ì— `--legacy-peer-deps` í‚¤ì›Œë“œë³´ë‹¤ ì—„ê²©í•˜ë‹¤ê³  ë³¼ ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤.